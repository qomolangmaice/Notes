第四章 外围设备

——>通过I/O口控制外部设备绝不像有些读者想像的去驱动一组发光二极管那么简单。在单片机的后向通道控制系统中，常用断电器控制器件功率

——>测量和控制是单片机系统一个非常重要的应用领域。典型的应用模式是通过传感器采集现场的微弱信号参数，经过数据处理后再通过A/D模数转换送到单片机系统进行各种工业调节和控制。

——>在单片机系统中，与传感器的接口通常称之为前向通道接口

——>继电器：单片机应用中，开关量都通过单片机I/O口或扩展I/O口输出来的，这些I/O口的驱动电流往往不足以驱动一些功率开关往往需要用到一些特殊的设备来控制大功率的器件

——>继电器：一种器件，它们响应小的电流或者电压变化，激活电路中的开关或者其他设备。可以用于远程地切换信号或电源

——>继电器分为机械继电器和固态继电器

——>机械继电器：驱动器的选择要根据继电器的吸合电流而定，即驱动器的电流一定要大于继电器的吸合电流。继电器的选择是根据的需要，结合负载电流，负载功率选择合适的继电器

——>固态继电器：固态继电器是一种新型的无触点电子继电器，输入端只需极小的控制电流，输出则用双向的晶闸管控制负载，输入、输出均通过内部光电耦合器隔离；具有外界元器件少、控制电压低、电流小、搞干扰性强、易于与单片机接口的特点

——>继电器的实际使用中，我们需要注意的关键问题主要有两点：一是功率驱动，二是抗干扰

——>A/D转换器：传感器将自然界获得的模拟信号转换成MCU能识别的电信号，也就是我们常说的AD转换；除了要选合适的传感器以外，还要将传感器采集来的微弱的信号放大

——>设计软件的时候要注意：片选(CS)脉冲要在每次的开始处，或者在转换时序的开始处变化一次后保持CS为低，直到时序结束

——>信号量可以分为模拟信号量和数字信号量。模拟信号量是连续变化的信号，在自然界中，存在着大量的信号量

——>传感器：能够感知外界的信息并能按照一定的规律将这些转换成可用的信号装置。简单地说就是一种将物理量或化学量转化成可利用的电信号器件

——>MCU相当于人的大脑，传感器就相当于人的各式各样的感觉器官。传感器将从自然界中获取到的信息传给“大脑”。然后大脑进行“分析、判断、决断”

——>自然界中物体只要它本身温度高于绝对零度又低于500度，就会成为红外线辐射源；许多物质对可见光是透明体，但对有些红外光是不透明体，反过来也一样。

——>红外传感器：红外传感器主要用来检测是否有障碍物，一般由两只红外管构成的，一只发射，一只接收

——>灰度传感器：所谓灰度也可认为是亮度，简单的说就是色彩的深浅程度。根据反射光的强度，可以判断出物体的灰级程度

——>亮度传感器：亮度传感器可以是一个简单的光敏电阻，其原理与热敏电阻类似，阻值随着外界亮度的不同而发生变化，使用时也必须事先确定阻值和亮度的对应关系；只要这个传感器可以“看到”LED，就表示一切正常，一旦光被挡住，你就可以知道有人或别的物体从传感器和LED之间经过

——>超声波传感器：按其工作原理可分为压电式、磁致伸缩式、电磁式等，以压电式最为常用

——>温度传感器：温度传感器的应用范围很广，最显著的例子就是环境监控或气象站，不过也可以拿来感应室内的温度，并对加热或制冷系统进行适当的控制，将其和数据记录仪相连，你就拥有一个温度记录器

——>最常用的电阻温度传感器，电阻的阻值随着温度的变化而变化

——>根据原理的不同主要分为半导体热电偶传感器、PN结温度传感器和集成温度传感器

——>热电偶传感器主要原理是：两种不同的材质连在一起，对这个连接点进行加热，在它们的不加热部位就会出现电位差，而这种电位差与它们在不加热点的温度和它们的材质有关

——>PN结温度传感器利用半导体材料和器件的某些性能参数的温度依赖性，实现对温度的检测，控制和补偿的功能

——>随着外界温度的不同，热敏电阻的阻值会发生相应变化，这时输入MCU的A/D转换通道的电压值也跟着发生变化；热敏电阻只能作为精度不高的温度测试工具

——>温度传感器：最简单的温度传感器为湿敏电阻或者湿敏电阻

——>湿敏电阻的特点是在基片上覆盖一层用感湿材料制成的膜，当空气中的水蒸气吸附在感湿膜上时，元件的电阻率和电阻值都发生变化，利用这一特性即可测量温度。而湿敏电容一般是高分子薄膜电容制成的，当环境发生改变时，湿敏电容的介电常数发生变化，使其电容量也发生变化，其电容变化量与相对温度成正比

——>磁卡(Magnetic Card)是一种卡片状的磁性记录介质，与各种读卡器配合作用

——>以前在磁卡上应用的安全技术，如水印技术、全息技术、精密磁记录技术等，随着时间的推移其相对安全性已大为降低

——>IC卡(芯片型智能卡的一种)则是通过芯片上写有的密钥参数进行识别的。IC卡在使用时，必须要通过与读写设备间特有的双向密钥认证。

——>把适合的存储卡当作一个可移动存储器，从而可以通过读卡器读写存储卡

——>按所兼容存储卡的各类分可以分为CF卡读卡器、SM卡读卡吕、PCMICA卡读卡器以及记忆棒读写器等

——>液晶显示器(Liquid Crystal Display，LCD)基本特点

1.低电压微功耗，液晶显示器件为电池供电的电子设备的首先显示器件

2.平板型结构

3.使用寿命长

4.被动显式。对LCD来说，环境光线越强显示内容越清晰。人眼所感受的外部信息90%以上是外部物体对光的反射，而不是物体本身发光，所以被动显式更适合人的视觉习惯，更不容易引起疲劳。这在信息量大、显示密度高、观看时间长的场合显得更重要

5.显示信息量大且易于彩色化

6.无电磁辐射

——>从程序员角度来说，LCD的显示接口与编程是面向HD44780的，只在了解HD44780的编程结构即可进行LCD的显示编程

——>键盘是由若干个热键组成的开关矩阵，它是最简单的MCU的数字量输入设备。键盘的基本电路为接触开关

——>独立方式：独立方式是指将每个按键按一对一的方式直接拉到I/O输入线上；读键值时直接读I/O口，每一个键的状态通过读入键值来反映，所以也称这种方式为一维直读方式，按习惯称为独立式；这种方式查键实现简单，但占用I/O资源较多，一般在键的数量较少时候使用

——>矩阵方式：矩阵方式是用n条I/O线组成行输入口，m条I/O线组成列输出口，在行列线的每一个交点上设置一个按键；这种方式占用I/O线较少，在实际应用系统中采用较多

——>设计键盘的时候，通常小于4个按键的应用，可以使用独立式接口。如果多于4个按键，为了减少处理器的I/O端口的占用，可以使用矩阵式键盘

——>键的识别：若键盘上闭合键的识别由专用硬件实现，称为编码键盘；而靠软件实现的称为未编码键盘

——>识别是否有键被按下，主要有查询法、定时扫描法与中断法等。而要识别键盘上哪个键被按下主要有行扫描法与行反转法

——>抖动问题：当手按下键时，会出现所按的键在闭合位置和断开位置之间跳几下才稳定到闭合状态的情况，当释放一个按键时也会出现类似情况，这就是抖动问题

——>在软件上，解决抖动的方法通常是延迟等待抖动的消失或多次识别判定

——>重键问题：所谓重键问题就是有两个及两个以上按键同时处于闭合状态的处理问题，在软件上，处理重键问题通常有连锁法与巡回法

——>当键盘上某一个闭合时，则该所对应的行线与列线短路

——>把列线n1~n4拉到MCU的输入口，行线m1~m4拉到MCU的输出口

——>逐行逐列检查键盘状态的过程称为对键盘的一次扫描。

——>CPU可随时响应键输入请求。也可以采用中断方式，当键盘上有键闭合时，向CPU请求中断
